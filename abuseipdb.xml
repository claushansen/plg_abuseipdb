<?xml version="1.0" encoding="utf-8"?>
<extension version="3.7" type="plugin" group="system">
    <name>System - IPBlocking of offenders registered in AbuseIPDB</name>
    <author>Claus Hansen</author>
    <creationDate>November 2017</creationDate>
    <copyright>Copyright (C) 2017 Holder. All rights reserved.</copyright>
    <license>GNU General Public License</license>
    <authorEmail>webkonsulent.claus.hansen@gmail.com</authorEmail>
    <authorUrl>https://expoze.dk</authorUrl>
    <version>1.0.1</version>
    <description>Block visitors if they are registered in AbuseIPDB</description>
    <files>
        <filename plugin="abuseipdb">abuseipdb.php</filename>
        <filename plugin="abuseipdb">install.mysql.utf8.sql</filename>
        <filename plugin="abuseipdb">uninstall.mysql.utf8.sql</filename>
    </files>
    <install>
        <sql>
            <file driver="mysql" charset="utf8">install.mysql.utf8.sql</file>
        </sql>
    </install>
    <uninstall>
        <sql>
            <file driver="mysql" charset="utf8">uninstall.mysql.utf8.sql</file>
        </sql>
    </uninstall>
    <config>
        <fields name="params">
            <fieldset name="basic">
                <field
                        name="APIkey"
                        type="text"
                        default=""
                        label="AbuseIPDB APIkey"
                        required="true"
                        description="Your APIkey from AbuseIPDB.com"
                        />
                <field
                        name="lookup_period"
                        type="list"
                        default="30"
                        label="Lookup Period"
                        description="Choose the period of time to look back in time.">
                    <option value="7">1 Week</option>
                    <option value="14">2 Weeks</option>
                    <option value="21">3 Weeks</option>
                    <option value="30">1 Month</option>
                </field>
                <field
                        name="min_attempts"
                        type="text"
                        default="1"
                        label="Minimum registered Attempts"
                        required="true"
                        description="How many times should a IP have been registered in AbuseIPDB before you want to reject"
                        />
                <field
                        name="whitelist"
                        type="textarea"
                        default="::1&#13;&#10;127.0.0.1"
                        label="Whitelist IPs"
                        description="List of IPs that should not be tested against AbuseIPDB.&lt;br /&gt;One IP per line."
                        rows="10"
                        cols="5"
                        />
                <field
                        name="blacklist"
                        type="textarea"
                        default=""
                        label="Blacklist IPs"
                        description="List of IPs that that will be blocked allways.&lt;br /&gt;One IP per line."
                        rows="10"
                        cols="5"
                        />
            </fieldset>
        </fields>
    </config>
</extension>